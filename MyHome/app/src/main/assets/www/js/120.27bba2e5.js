"use strict";(self["webpackChunkmy_home"]=self["webpackChunkmy_home"]||[]).push([[120],{1114:function(e,t,a){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function l(e,t){if("object"!=n(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var l=a.call(e,t||"default");if("object"!=n(l))return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function o(e){var t=l(e,"string");return"symbol"==n(t)?t:t+""}function s(e,t,a){return(t=o(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}a.d(t,{A:function(){return s}})},1241:function(e,t){t.A=(e,t)=>{const a=e.__vccOpts||e;for(const[n,l]of t)a[n]=l;return a}},5120:function(e,t,a){a.r(t),a.d(t,{default:function(){return P}});var n=a(6768),l=a(4232),o=a(144),s=a(5574);function i(){const e=(0,o.KR)(!1),t=(0,o.KR)(25),a=(0,o.KR)("COOLING"),n=(0,o.KR)(-1),l=(0,o.KR)("UNKNOWN"),s=(0,o.KR)(!1),i=(0,o.KR)(!1),r=(0,o.KR)(0),u=(0,o.KR)(0);return{isPowerOn:e,temperature:t,mode:a,fanSpeed:n,windDirection:l,isAutoSwing:s,isScreenDisplay:i,timerStartTimestamp:r,timerEndTimestamp:u}}const r={class:"air-conditioner"},u={class:"air-conditioner__content"},c={class:"mqtt-status"},v={class:"countdown"},d={class:"temperature-display"},m={class:"temperature"},f={class:"mode-display"},k={class:"wind-direction-indicators"},p={class:"indicator-item"},L={class:"control-buttons"},b={key:0,class:"timer-dialog-overlay"},C={class:"timer-dialog"},h={class:"timer-display"},g={class:"timer-hours"},S={class:"timer-minutes"},A={key:1,class:"timer-dialog-overlay"},y={class:"timer-dialog"},w={class:"good-evening-section"},_={class:"timer-display"},E={class:"timer-hours"},T={class:"timer-minutes"},R={class:"good-evening-section"},K={class:"timer-display"},I={class:"timer-hours"},O={class:"timer-minutes"};var N=(0,n.pM)({name:"air-conditioner",__name:"air-conditioner",setup(e){const t=i();let a;try{a=new(window.AudioContext||window.webkitAudioContext)}catch(ge){console.error("Web Audio API is not supported in this browser:",ge)}const N=()=>{if(!a)return;"suspended"===a.state&&a.resume();const e=a.createOscillator(),t=a.createGain();e.connect(t),t.connect(a.destination),e.frequency.value=350,e.type="sine",t.gain.setValueAtTime(0,a.currentTime),t.gain.linearRampToValueAtTime(.2,a.currentTime+.01),t.gain.exponentialRampToValueAtTime(.01,a.currentTime+.1),e.start(a.currentTime),e.stop(a.currentTime+.1)},D=(0,o.KR)(!1),M=(0,o.KR)(!1),P=(0,o.KR)(1),G=(0,o.KR)(0),B=(0,o.KR)(!1),V=(0,o.KR)(""),W=(0,o.KR)(0),j=(0,o.KR)("");let x=null;const H=(0,o.KR)(!1),$=(0,o.KR)(1),J=(0,o.KR)(0),q=(0,o.KR)(2),Q=(0,o.KR)(0),F=(0,o.KR)(!1),X=(0,n.EW)((()=>{const e={COOLING:"制冷模式",HEATING:"制热模式",fan:"送风模式",dry:"除湿模式",auto:"自动模式"};return e[t.mode.value]})),z=(0,n.EW)((()=>{const e={COOLING:"fa-snowflake-o",HEATING:"fa-sun-o",fan:"fa-wind",dry:"fa-tint",auto:"fa-refresh"};return e[t.mode.value]})),U=()=>{N(),t.isPowerOn.value=!t.isPowerOn.value,t.timerStartTimestamp.value=-1,t.timerEndTimestamp.value=-1,s.A.send("bedroomAC/togglePower")},Y=()=>{N(),t.temperature.value<32&&(t.temperature.value++,s.A.send("bedroomAC/increaseTemperature"))},Z=()=>{N(),t.temperature.value>16&&(t.temperature.value--,s.A.send("bedroomAC/decreaseTemperature"))},ee=()=>{N(),t.isScreenDisplay.value=!t.isScreenDisplay.value,s.A.send("bedroomAC/toggleSleepMode")},te=()=>{N(),t.mode.value="COOLING",s.A.send("bedroomAC/setCoolingMode")},ae=()=>{N(),t.mode.value="HEATING",s.A.send("bedroomAC/setHeatingMode")},ne=()=>{N();const e=[-1,1,2,3,4,5,6,7],a=e.indexOf(t.fanSpeed.value);t.fanSpeed.value=e[(a+1)%e.length],s.A.send("bedroomAC/toggleWindSpeed")},le=()=>{N(),t.isAutoSwing.value=!t.isAutoSwing.value,s.A.send("bedroomAC/toggleSwing")},oe=()=>{N(),M.value=!0},se=()=>{N(),F.value=!1,V.value="",t.timerStartTimestamp.value=0,t.timerEndTimestamp.value=0,s.A.send("bedroomAC/cancelTiming")},ie=()=>{N(),P.value+=1,P.value>9&&(P.value=9),G.value=0},re=()=>{N(),P.value<=1||(P.value-=1,G.value=0)},ue=()=>{N(),F.value=!0,s.A.send("bedroomAC/setTiming",{hours:P.value});const e=P.value.toString().padStart(2,"0"),a=G.value.toString().padStart(2,"0");V.value=`${e}:${a}`,W.value=3600*P.value+60*G.value,t.timerStartTimestamp.value=Date.now(),t.timerEndTimestamp.value=Date.now()+1e3*W.value,M.value=!1},ce=()=>{N(),M.value=!1},ve=()=>{N(),H.value=!1},de=()=>{N(),J.value+=30,J.value>=60&&($.value+=Math.floor(J.value/60),J.value=J.value%60),$.value>=24&&($.value=23,J.value=30)},me=()=>{if(N(),0===J.value){if(0===$.value)return;$.value-=1,J.value=30}else J.value-=30},fe=()=>{N(),Q.value+=30,Q.value>=60&&(q.value+=Math.floor(Q.value/60),Q.value=Q.value%60),q.value>=24&&(q.value=23,Q.value=30)},ke=()=>{if(N(),0===Q.value){if(0===q.value)return;q.value-=1,Q.value=30}else Q.value-=30},pe=()=>{N();const e=60*$.value+J.value,t=60*q.value+Q.value;s.A.send("bedroomAC/goodEvening",{openMinute:e,closeMinute:t}),H.value=!1},Le=()=>{x&&clearInterval(x),be(),x=setInterval((()=>{be()}),1e3)},be=()=>{const e=Math.floor((t.timerEndTimestamp.value-Date.now())/1e3);if(e<=0)return j.value="00:00:00",void(F.value=!1);const a=Math.floor(e/3600),n=Math.floor(e%3600/60),l=e%60;j.value=`${a.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`,F.value=!0};(0,n.wB)(B,(e=>{e&&V.value&&console.log(`已设置定时时间: ${V.value}`)}));const Ce=e=>{D.value=e},he=e=>{t.isPowerOn.value=e.isPowerOn,t.temperature.value=e.temperature,t.mode.value=e.mode,t.fanSpeed.value=e.fanSpeed,t.windDirection.value=e.windDirection,t.isAutoSwing.value=e.isAutoSwing,t.isScreenDisplay.value=e.isScreenDisplay,F.value=e.isTiming,t.timerStartTimestamp.value=e.timerStartTimestamp??0,t.timerEndTimestamp.value=e.timerEndTimestamp??0};return(0,n.sV)((()=>{s.A.globalChannel.on("mqttConnectState",Ce),s.A.invoke("bedroomAC/getMQTTState").then((e=>{D.value=e})).catch((e=>{console.error("获取MQTT状态失败:",e)})),s.A.invoke("bedroomAC/getACState").then((e=>{const t=JSON.parse(e);console.log("获取空调状态:",t),he(t)})),s.A.globalChannel.on("syncBedroomACState",(e=>{const t=JSON.parse(e);console.log("空调状态更新1:",t),he(t)})),Le()})),(0,n.hi)((()=>{x&&clearInterval(x),s.A.globalChannel.off("mqttConnectState",Ce)})),(e,a)=>((0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.Lk)("div",r,[(0,n.Lk)("div",u,[(0,n.Lk)("div",c,[(0,n.Lk)("i",{class:(0,l.C4)(["fa","status-icon",{"fa-check-circle":D.value,"fa-exclamation-circle":!D.value}])},null,2),(0,n.Lk)("span",{class:(0,l.C4)({connected:D.value,disconnected:!D.value})},(0,l.v_)(D.value?"已连接":"未连接"),3)]),(0,n.Lk)("div",{style:(0,l.Tr)({display:F.value?"block":"none",overflow:"hidden"}),class:"run-time"},[a[1]||(a[1]=(0,n.Lk)("i",{class:"fa fa-clock-o"},null,-1)),(0,n.Lk)("span",v,(0,l.v_)(j.value),1)],4),(0,n.Lk)("div",d,[(0,n.Lk)("span",m,(0,l.v_)((0,o.R1)(t).temperature.value),1),a[2]||(a[2]=(0,n.Lk)("span",{class:"unit"},"°C",-1))]),(0,n.Lk)("div",f,[(0,n.Lk)("i",{class:(0,l.C4)(["fa",z.value])},null,2),(0,n.eW)(" "+(0,l.v_)(X.value),1)]),(0,n.Lk)("div",k,[(0,n.Lk)("div",p,[(0,n.Lk)("i",null,(0,l.v_)([0,1,2,3,4,5,6,7][(0,o.R1)(t).fanSpeed.value]??"au"),1),a[3]||(a[3]=(0,n.Lk)("span",null,"风速",-1))]),a[4]||(a[4]=(0,n.Lk)("div",{class:"indicator-item"},[(0,n.Lk)("i",{class:"fa fa-exchange"}),(0,n.Lk)("span",null,"上下风向")],-1)),a[5]||(a[5]=(0,n.Lk)("div",{class:"indicator-item"},[(0,n.Lk)("i",{class:"fa fa-arrows-h"}),(0,n.Lk)("span",null,"左右风向")],-1))]),(0,n.Lk)("div",L,[(0,n.Lk)("button",{class:"control-btn",onClick:Z},a[6]||(a[6]=[(0,n.Lk)("i",{class:"fa fa-minus"},null,-1)])),(0,n.Lk)("button",{class:"control-btn power-btn",onClick:U},[(0,n.Lk)("i",{class:(0,l.C4)(["fa fa-power-off",{active:(0,o.R1)(t).isPowerOn.value}])},null,2)]),(0,n.Lk)("button",{class:"control-btn",onClick:Y},a[7]||(a[7]=[(0,n.Lk)("i",{class:"fa fa-plus"},null,-1)])),(0,n.Lk)("button",{class:"control-btn",onClick:ee},[(0,n.Lk)("i",{class:(0,l.C4)(["fa fa-moon-o",{active:(0,o.R1)(t).isScreenDisplay.value}])},null,2),a[8]||(a[8]=(0,n.Lk)("span",null,"睡眠",-1))]),(0,n.Lk)("button",{class:"control-btn",onClick:te},[(0,n.Lk)("i",{class:(0,l.C4)(["fa fa-snowflake-o",{active:"COOLING"===(0,o.R1)(t).mode.value}])},null,2),a[9]||(a[9]=(0,n.Lk)("span",null,"制冷",-1))]),(0,n.Lk)("button",{class:"control-btn",onClick:ae},[(0,n.Lk)("i",{class:(0,l.C4)(["fa fa-sun-o",{active:"HEATING"===(0,o.R1)(t).mode.value}])},null,2),a[10]||(a[10]=(0,n.Lk)("span",null,"制热",-1))]),(0,n.Lk)("button",{class:"control-btn",onClick:a[0]||(a[0]=e=>F.value?se():oe())},[(0,n.Lk)("i",{class:(0,l.C4)(["fa fa-clock-o",{active:F.value}])},null,2),(0,n.Lk)("span",null,(0,l.v_)(F.value?"取消定时":"定时"),1)]),(0,n.Lk)("button",{class:"control-btn",onClick:ne},a[11]||(a[11]=[(0,n.Lk)("i",{class:"fa fa-tachometer"},null,-1),(0,n.Lk)("span",null,"风速",-1)])),(0,n.Lk)("button",{class:"control-btn",onClick:le},[(0,n.Lk)("i",{class:(0,l.C4)(["fa fa-arrows-v",{active:(0,o.R1)(t).isAutoSwing.value}])},null,2),a[12]||(a[12]=(0,n.Lk)("span",null,"摆风",-1))])])])]),M.value?((0,n.uX)(),(0,n.CE)("div",b,[(0,n.Lk)("div",C,[a[16]||(a[16]=(0,n.Lk)("h3",null,"设置定时时间",-1)),(0,n.Lk)("div",h,[(0,n.Lk)("span",g,(0,l.v_)(P.value.toString().padStart(2,"0")),1),a[13]||(a[13]=(0,n.Lk)("span",{class:"timer-separator"},":",-1)),(0,n.Lk)("span",S,(0,l.v_)(G.value.toString().padStart(2,"0")),1)]),(0,n.Lk)("div",{class:"timer-controls"},[(0,n.Lk)("button",{class:"timer-btn",onClick:re},a[14]||(a[14]=[(0,n.Lk)("i",{class:"fa fa-minus"},null,-1)])),(0,n.Lk)("button",{class:"timer-btn",onClick:ie},a[15]||(a[15]=[(0,n.Lk)("i",{class:"fa fa-plus"},null,-1)]))]),(0,n.Lk)("div",{class:"timer-confirm"},[(0,n.Lk)("button",{class:"confirm-btn",onClick:ue},"确认"),(0,n.Lk)("button",{class:"cancel-btn",onClick:ce},"取消")])])])):(0,n.Q3)("",!0),H.value?((0,n.uX)(),(0,n.CE)("div",A,[(0,n.Lk)("div",y,[a[25]||(a[25]=(0,n.Lk)("h3",null,"设置晚安模式",-1)),(0,n.Lk)("div",w,[a[20]||(a[20]=(0,n.Lk)("h4",null,"开启时长",-1)),(0,n.Lk)("div",_,[(0,n.Lk)("span",E,(0,l.v_)($.value.toString().padStart(2,"0")),1),a[17]||(a[17]=(0,n.Lk)("span",{class:"timer-separator"},":",-1)),(0,n.Lk)("span",T,(0,l.v_)(J.value.toString().padStart(2,"0")),1)]),(0,n.Lk)("div",{class:"timer-controls"},[(0,n.Lk)("button",{class:"timer-btn",onClick:me},a[18]||(a[18]=[(0,n.Lk)("i",{class:"fa fa-minus"},null,-1)])),(0,n.Lk)("button",{class:"timer-btn",onClick:de},a[19]||(a[19]=[(0,n.Lk)("i",{class:"fa fa-plus"},null,-1)]))])]),(0,n.Lk)("div",R,[a[24]||(a[24]=(0,n.Lk)("h4",null,"关闭时长",-1)),(0,n.Lk)("div",K,[(0,n.Lk)("span",I,(0,l.v_)(q.value.toString().padStart(2,"0")),1),a[21]||(a[21]=(0,n.Lk)("span",{class:"timer-separator"},":",-1)),(0,n.Lk)("span",O,(0,l.v_)(Q.value.toString().padStart(2,"0")),1)]),(0,n.Lk)("div",{class:"timer-controls"},[(0,n.Lk)("button",{class:"timer-btn",onClick:ke},a[22]||(a[22]=[(0,n.Lk)("i",{class:"fa fa-minus"},null,-1)])),(0,n.Lk)("button",{class:"timer-btn",onClick:fe},a[23]||(a[23]=[(0,n.Lk)("i",{class:"fa fa-plus"},null,-1)]))])]),(0,n.Lk)("div",{class:"timer-confirm"},[(0,n.Lk)("button",{class:"confirm-btn",onClick:pe},"确认"),(0,n.Lk)("button",{class:"cancel-btn",onClick:ve},"取消")])])])):(0,n.Q3)("",!0)],64))}}),D=a(1241);const M=(0,D.A)(N,[["__scopeId","data-v-4ca70fda"]]);var P=M},5574:function(e,t,a){a.d(t,{A:function(){return h}});var n=a(1114);a(8111),a(7588),a(7642),a(8004),a(3853),a(5876),a(2475),a(5024),a(1698);function l(){return Date.now().toString(36)+Math.random().toString(36).substring(2)}const o={webViewInterfaceKey:"__BRIDGE_WEB_VIEW_INTERFACE__",webInterfaceKey:"__BRIDGE_WEB_INTERFACE__",globalEventChannelId:"__GLOBAL_EVENT_CHANNEL__",resolveCallbackKey:"__RESOLVE_CALLBACK__",rejectCallbackKey:"__REJECT_CALLBACK__"},s=window[o.webViewInterfaceKey];function i(){return!!s}function r(e){s?.callMethod(JSON.stringify(e))}function u(e){s?.triggerEvent(JSON.stringify(e))}function c(){s?.resetBridge()}const v=new Map;class d{constructor(e=l()){(0,n.A)(this,"events",new Map),(0,n.A)(this,"id",void 0),(0,n.A)(this,"on",((e,t)=>{this.events.has(e)||this.events.set(e,new Set),this.events.get(e).add(t)})),(0,n.A)(this,"only",((e,t)=>{const a=n=>{t(n),this.off(e,a)};this.on(e,a)})),(0,n.A)(this,"off",((e,t)=>{const a=this.events.get(e);a&&(a.delete(t),0===a.size&&this.events.delete(e))})),(0,n.A)(this,"emit",((e,t)=>{const a=this.events.get(e);a&&a.forEach((e=>e(t)))})),(0,n.A)(this,"send",((e,t)=>{u({channelId:this.id,eventName:e,payload:t,isDone:!1})})),(0,n.A)(this,"done",((e,t)=>{u({channelId:this.id,eventName:e,payload:t,isDone:!0}),this.close()})),(0,n.A)(this,"close",(()=>{this.events.clear(),v.delete(this.id)})),this.id=e,v.set(this.id,this)}}function m(e){const t=v.get(e.channelId);void 0!==t&&(e.eventName&&t.emit(e.eventName,e.payload),e.isDone&&(t.emit(e.isError?o.rejectCallbackKey:o.resolveCallbackKey,e.payload),t.close()))}function f(e){console.error(e)}function k(){window[o.webInterfaceKey]={triggerEvent:m,throwError:f}}const p=new d(o.globalEventChannelId);function L(e,t){r({apiPath:e,payload:t})}function b(e,t){const a=new d;return r({channelId:a.id,apiPath:e,payload:t}),new Promise(((e,t)=>{a.only(o.resolveCallbackKey,e),a.only(o.rejectCallbackKey,t)}))}function C(e){const t=new d,a=a=>{r({channelId:t.id,apiPath:e,payload:a})};return{on:t.on,only:t.only,off:t.off,send:t.send,done:t.done,connect:a}}k(),window.addEventListener("beforeunload",c);var h={available:i,globalChannel:p,send:L,invoke:b,createSocket:C}}}]);
//# sourceMappingURL=120.27bba2e5.js.map